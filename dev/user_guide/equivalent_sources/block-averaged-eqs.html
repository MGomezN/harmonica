

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
        <title>Block-averaged equivalent sources | Harmonica dev</title>
    

    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-book-theme.css?digest=84ace793992934648b4de8eed757e5a2" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/thebelab-helper.js"></script>
    <script src="../../_static/design-tabs.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script src="../../_static/sphinx-book-theme.9d8b4a8b9bb19db25eeaddc40d639ba2.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Gradient-boosted equivalent sources" href="gradient-boosted-eqs.html" />
    <link rel="prev" title="Estimating damping and depth parameters" href="eqs-parameters-estimation.html" />
    <!-- Plausible analytics for anonymous usage statistics -->
    <script defer data-domain="fatiando.org" src="https://plausible.io/js/plausible.js"></script>

  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<div class="col-12 col-md-3 bd-sidebar site-navigation " id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/harmonica-logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Harmonica <span class="project-version">dev</span></h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../overview.html">
   Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../install.html">
   Installing
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../gallery/index.html">
   Gallery
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../gallery/gravity_disturbance.html">
     Gravity Disturbances
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../gallery/gravity_disturbance_topofree.html">
     Topography-free (Bouguer) Gravity Disturbances
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../gallery/isostatic_moho_airy.html">
     Airy Isostatic Moho
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../gallery/equivalent_sources/block_averaged_sources.html">
     Gridding with block-averaged equivalent sources
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../gallery/equivalent_sources/cartesian.html">
     Gridding and upward continuation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../gallery/equivalent_sources/gradient_boosted.html">
     Gradient-boosted equivalent sources
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../gallery/equivalent_sources/spherical.html">
     Gridding in spherical coordinates
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../gallery/forward/point_gravity.html">
     Point Masses in Cartesian Coordinates
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../gallery/forward/prism_layer.html">
     Layer of prisms
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../gallery/forward/prisms_topo_gravity.html">
     Gravitational effect of topography
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../gallery/forward/tesseroid.html">
     Tesseroids (spherical prisms)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../gallery/forward/tesseroid_layer.html">
     Layer of tesseroids
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../gallery/forward/tesseroid_variable_density.html">
     Tesseroids with variable density
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../gallery/transformations/reduction_to_pole.html">
     Reduction to the pole of a magnetic anomaly grid
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../gallery/transformations/upward_continuation.html">
     Upward continuation of a regular grid
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../gallery/transformations/upward_derivative.html">
     Upward derivative of a regular grid
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../gallery/visualization/prism_layer_pyvista.html">
     Plot a prism layer in 3D
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  User Guide
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../coordinate_systems.html">
   Coordinate systems
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../forward_modelling/index.html">
   Forward modelling
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../forward_modelling/point.html">
     Point sources
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../forward_modelling/dipole.html">
     Magnetic dipoles
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../forward_modelling/prism.html">
     Rectangular prisms
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../forward_modelling/tesseroid.html">
     Tesseroids
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../gravity_disturbance.html">
   Gravity Disturbance
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../topographic_correction.html">
   Topographic Correction
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="index.html">
   Equivalent Sources
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="eqs-parameters-estimation.html">
     Estimating damping and depth parameters
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Block-averaged equivalent sources
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="gradient-boosted-eqs.html">
     Gradient-boosted equivalent sources
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="eq-sources-spherical.html">
     Equivalent sources in spherical coordinates
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../transformations.html">
   Grid transformations
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Reference documentation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../api/index.html">
   API Reference
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../api/generated/harmonica.bouguer_correction.html">
     harmonica.bouguer_correction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../api/generated/harmonica.derivative_easting.html">
     harmonica.derivative_easting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../api/generated/harmonica.derivative_northing.html">
     harmonica.derivative_northing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../api/generated/harmonica.derivative_upward.html">
     harmonica.derivative_upward
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../api/generated/harmonica.upward_continuation.html">
     harmonica.upward_continuation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../api/generated/harmonica.gaussian_lowpass.html">
     harmonica.gaussian_lowpass
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../api/generated/harmonica.gaussian_highpass.html">
     harmonica.gaussian_highpass
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../api/generated/harmonica.reduction_to_pole.html">
     harmonica.reduction_to_pole
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../api/generated/harmonica.filters.derivative_easting_kernel.html">
     harmonica.filters.derivative_easting_kernel
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../api/generated/harmonica.filters.derivative_northing_kernel.html">
     harmonica.filters.derivative_northing_kernel
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../api/generated/harmonica.filters.derivative_upward_kernel.html">
     harmonica.filters.derivative_upward_kernel
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../api/generated/harmonica.filters.upward_continuation_kernel.html">
     harmonica.filters.upward_continuation_kernel
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../api/generated/harmonica.filters.gaussian_lowpass_kernel.html">
     harmonica.filters.gaussian_lowpass_kernel
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../api/generated/harmonica.filters.gaussian_highpass_kernel.html">
     harmonica.filters.gaussian_highpass_kernel
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../api/generated/harmonica.filters.reduction_to_pole_kernel.html">
     harmonica.filters.reduction_to_pole_kernel
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../api/generated/harmonica.EquivalentSources.html">
     harmonica.EquivalentSources
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../api/generated/harmonica.EquivalentSourcesGB.html">
     harmonica.EquivalentSourcesGB
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../api/generated/harmonica.EquivalentSourcesSph.html">
     harmonica.EquivalentSourcesSph
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../api/generated/harmonica.point_gravity.html">
     harmonica.point_gravity
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../api/generated/harmonica.prism_gravity.html">
     harmonica.prism_gravity
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../api/generated/harmonica.tesseroid_gravity.html">
     harmonica.tesseroid_gravity
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../api/generated/harmonica.dipole_magnetic.html">
     harmonica.dipole_magnetic
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../api/generated/harmonica.dipole_magnetic_component.html">
     harmonica.dipole_magnetic_component
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../api/generated/harmonica.prism_magnetic.html">
     harmonica.prism_magnetic
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../api/generated/harmonica.prism_layer.html">
     harmonica.prism_layer
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../api/generated/harmonica.tesseroid_layer.html">
     harmonica.tesseroid_layer
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../api/generated/harmonica.DatasetAccessorPrismLayer.html">
     harmonica.DatasetAccessorPrismLayer
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../api/generated/harmonica.DatasetAccessorTesseroidLayer.html">
     harmonica.DatasetAccessorTesseroidLayer
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../api/generated/harmonica.isostatic_moho_airy.html">
     harmonica.isostatic_moho_airy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../api/generated/harmonica.load_icgem_gdf.html">
     harmonica.load_icgem_gdf
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../api/generated/harmonica.load_oasis_montaj_grid.html">
     harmonica.load_oasis_montaj_grid
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../api/generated/harmonica.visualization.prism_to_pyvista.html">
     harmonica.visualization.prism_to_pyvista
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../api/generated/harmonica.magnetic_vec_to_angles.html">
     harmonica.magnetic_vec_to_angles
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../api/generated/harmonica.magnetic_angles_to_vec.html">
     harmonica.magnetic_angles_to_vec
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../citing.html">
   Citing Harmonica
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../references.html">
   References
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../changes.html">
   Changelog
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../compatibility.html">
   Version compatibility
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../versions.html">
   Documentation for other versions
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Community
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference external" href="https://www.fatiando.org/contact">
   Join the community
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://github.com/fatiando/harmonica/blob/main/CONTRIBUTING.md">
   How to contribute
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://github.com/fatiando/community/blob/main/CODE_OF_CONDUCT.md">
   Code of Conduct
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://github.com/fatiando/harmonica">
   Source code on GitHub
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://www.fatiando.org">
   The Fatiando a Terra project
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
</div>

</div>


          


          
<!-- This is an invisible pixel that we watch to see if we've scrolled. -->
<div class="sbt-scroll-pixel-helper"></div>
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            <div class="topbar-left">
                
                <label class="nav-toggle-button" for="__navigation">
                    <div class="visually-hidden">Toggle navigation</div>
                    <i class="fas fa-bars"></i>
                </label>
                
            </div>
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/user_guide/equivalent_sources/block-averaged-eqs.rst.txt"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.rst</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/fatiando/harmonica"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/fatiando/harmonica/issues/new?title=Issue%20on%20page%20%2Fuser_guide/equivalent_sources/block-averaged-eqs.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/fatiando/harmonica/edit/main/doc/user_guide/equivalent_sources/block-averaged-eqs.rst"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Block-averaged equivalent sources</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="section" id="block-averaged-equivalent-sources">
<span id="block-averaged-eqs"></span><h1>Block-averaged equivalent sources<a class="headerlink" href="#block-averaged-equivalent-sources" title="Permalink to this headline">¶</a></h1>
<p>When we introduced the <a class="reference internal" href="index.html#equivalent-sources"><span class="std std-ref">Equivalent Sources</span></a> we saw that
by default the <a class="reference internal" href="../../api/generated/harmonica.EquivalentSources.html#harmonica.EquivalentSources" title="harmonica.EquivalentSources"><code class="xref py py-class docutils literal notranslate"><span class="pre">harmonica.EquivalentSources</span></code></a> class locates one point
source beneath each data point during the fitting process, following
<a class="reference internal" href="../../references.html#cooper2000" id="id1"><span>[Cooper2000]</span></a>.</p>
<p>Alternatively, we can use another strategy: the <em>block-averaged sources</em>,
introduced in <a class="reference internal" href="../../references.html#soler2021" id="id2"><span>[Soler2021]</span></a>.
This method divides the survey region (defined by the data) into square blocks
of equal size, computes the median coordinates of the data points that fall
inside each block and locates one source beneath every averaged position. This
way, we define one equivalent source per block, with the exception of empty
blocks that won’t get any source.</p>
<p>This method has two main benefits:</p>
<ul class="simple">
<li><p>It lowers the amount of sources involved in the interpolation, therefore it
reduces the computer memory requirements and the computation time of the
fitting and prediction processes.</p></li>
<li><p>It might avoid to produce aliasing on the output grids, specially for
surveys with oversampling along a particular direction, like airborne ones.</p></li>
</ul>
<p>We can make use of the block-averaged sources within the
<a class="reference internal" href="../../api/generated/harmonica.EquivalentSources.html#harmonica.EquivalentSources" title="harmonica.EquivalentSources"><code class="xref py py-class docutils literal notranslate"><span class="pre">harmonica.EquivalentSources</span></code></a> class by passing a value to the
<code class="docutils literal notranslate"><span class="pre">block_size</span></code> parameter, which controls the size of the blocks.</p>
<p>Lets load some total-field magnetic data over Great Britain:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">ensaio</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">fname</span> <span class="o">=</span> <span class="n">ensaio</span><span class="o">.</span><span class="n">fetch_britain_magnetic</span><span class="p">(</span><span class="n">version</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>line_and_segment</th>
      <th>year</th>
      <th>longitude</th>
      <th>latitude</th>
      <th>height_m</th>
      <th>total_field_anomaly_nt</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>FL1-1</td>
      <td>1955</td>
      <td>-1.74162</td>
      <td>53.48164</td>
      <td>792</td>
      <td>62</td>
    </tr>
    <tr>
      <th>1</th>
      <td>FL1-1</td>
      <td>1955</td>
      <td>-1.70122</td>
      <td>53.48352</td>
      <td>663</td>
      <td>56</td>
    </tr>
    <tr>
      <th>2</th>
      <td>FL1-1</td>
      <td>1955</td>
      <td>-1.08051</td>
      <td>53.47677</td>
      <td>315</td>
      <td>30</td>
    </tr>
    <tr>
      <th>3</th>
      <td>FL1-1</td>
      <td>1955</td>
      <td>-1.07471</td>
      <td>53.47672</td>
      <td>315</td>
      <td>31</td>
    </tr>
    <tr>
      <th>4</th>
      <td>FL1-1</td>
      <td>1955</td>
      <td>-1.01763</td>
      <td>53.47586</td>
      <td>321</td>
      <td>44</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>541503</th>
      <td>FL-3(TL10-24)-1</td>
      <td>1965</td>
      <td>-4.68843</td>
      <td>58.26786</td>
      <td>1031</td>
      <td>64</td>
    </tr>
    <tr>
      <th>541504</th>
      <td>FL-3(TL10-24)-1</td>
      <td>1965</td>
      <td>-4.68650</td>
      <td>58.26786</td>
      <td>1045</td>
      <td>74</td>
    </tr>
    <tr>
      <th>541505</th>
      <td>FL-3(TL10-24)-1</td>
      <td>1965</td>
      <td>-4.68535</td>
      <td>58.26790</td>
      <td>1035</td>
      <td>94</td>
    </tr>
    <tr>
      <th>541506</th>
      <td>FL-3(TL10-24)-1</td>
      <td>1965</td>
      <td>-4.68419</td>
      <td>58.26787</td>
      <td>1024</td>
      <td>114</td>
    </tr>
    <tr>
      <th>541507</th>
      <td>FL-3(TL10-24)-1</td>
      <td>1965</td>
      <td>-4.68274</td>
      <td>58.26790</td>
      <td>1011</td>
      <td>120</td>
    </tr>
  </tbody>
</table>
<p>541508 rows × 6 columns</p>
</div></div></div>
</div>
<p>In order to speed-up calculations we are going to slice a smaller portion of
the data:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">verde</span> <span class="k">as</span> <span class="nn">vd</span>

<span class="n">region</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">5.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.7</span><span class="p">,</span> <span class="mf">57.8</span><span class="p">,</span> <span class="mf">58.5</span><span class="p">)</span>
<span class="n">inside</span> <span class="o">=</span> <span class="n">vd</span><span class="o">.</span><span class="n">inside</span><span class="p">((</span><span class="n">data</span><span class="o">.</span><span class="n">longitude</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">latitude</span><span class="p">),</span> <span class="n">region</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">inside</span><span class="p">]</span>
<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>line_and_segment</th>
      <th>year</th>
      <th>longitude</th>
      <th>latitude</th>
      <th>height_m</th>
      <th>total_field_anomaly_nt</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>383858</th>
      <td>FL-47-2</td>
      <td>1964</td>
      <td>-5.38345</td>
      <td>57.95592</td>
      <td>305</td>
      <td>112</td>
    </tr>
    <tr>
      <th>383859</th>
      <td>FL-47-2</td>
      <td>1964</td>
      <td>-5.38180</td>
      <td>57.95614</td>
      <td>305</td>
      <td>120</td>
    </tr>
    <tr>
      <th>383860</th>
      <td>FL-47-2</td>
      <td>1964</td>
      <td>-5.38011</td>
      <td>57.95633</td>
      <td>305</td>
      <td>150</td>
    </tr>
    <tr>
      <th>383861</th>
      <td>FL-47-2</td>
      <td>1964</td>
      <td>-5.37851</td>
      <td>57.95658</td>
      <td>305</td>
      <td>170</td>
    </tr>
    <tr>
      <th>383862</th>
      <td>FL-47-2</td>
      <td>1964</td>
      <td>-5.37650</td>
      <td>57.95693</td>
      <td>305</td>
      <td>220</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>538970</th>
      <td>FL-16(TL24-36)-6</td>
      <td>1965</td>
      <td>-4.70304</td>
      <td>58.49978</td>
      <td>319</td>
      <td>162</td>
    </tr>
    <tr>
      <th>541490</th>
      <td>FL-11-5</td>
      <td>1965</td>
      <td>-4.88674</td>
      <td>58.40691</td>
      <td>1056</td>
      <td>245</td>
    </tr>
    <tr>
      <th>541491</th>
      <td>FL-11-5</td>
      <td>1965</td>
      <td>-4.88377</td>
      <td>58.40689</td>
      <td>1069</td>
      <td>250</td>
    </tr>
    <tr>
      <th>541492</th>
      <td>FL-11-5</td>
      <td>1965</td>
      <td>-4.88202</td>
      <td>58.40724</td>
      <td>1055</td>
      <td>245</td>
    </tr>
    <tr>
      <th>541493</th>
      <td>FL-11-5</td>
      <td>1965</td>
      <td>-4.88047</td>
      <td>58.40728</td>
      <td>1041</td>
      <td>234</td>
    </tr>
  </tbody>
</table>
<p>7054 rows × 6 columns</p>
</div></div></div>
</div>
<p>And project the geographic coordinates to plain Cartesian ones:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyproj</span>

<span class="n">projection</span> <span class="o">=</span> <span class="n">pyproj</span><span class="o">.</span><span class="n">Proj</span><span class="p">(</span><span class="n">proj</span><span class="o">=</span><span class="s2">&quot;merc&quot;</span><span class="p">,</span> <span class="n">lat_ts</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="n">easting</span><span class="p">,</span> <span class="n">northing</span> <span class="o">=</span> <span class="n">projection</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">longitude</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">coordinates</span> <span class="o">=</span> <span class="p">(</span><span class="n">easting</span><span class="p">,</span> <span class="n">northing</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">height_m</span><span class="p">)</span>
<span class="n">xy_region</span><span class="o">=</span><span class="n">vd</span><span class="o">.</span><span class="n">get_region</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pygmt</span>

<span class="n">maxabs</span> <span class="o">=</span> <span class="n">vd</span><span class="o">.</span><span class="n">maxabs</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">total_field_anomaly_nt</span><span class="p">)</span><span class="o">*</span><span class="mf">.8</span>

<span class="c1"># Set figure properties</span>
<span class="n">w</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">xy_region</span>
<span class="n">fig_height</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">fig_width</span> <span class="o">=</span> <span class="n">fig_height</span> <span class="o">*</span> <span class="p">(</span><span class="n">e</span> <span class="o">-</span> <span class="n">w</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">s</span><span class="p">)</span>
<span class="n">fig_ratio</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">s</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">fig_height</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">fig_proj</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;x1:</span><span class="si">{</span><span class="n">fig_ratio</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="c1"># Plot original magnetic anomaly and the gridded and upward-continued version</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">pygmt</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

<span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Observed total-field magnetic anomaly&quot;</span>

<span class="n">pygmt</span><span class="o">.</span><span class="n">makecpt</span><span class="p">(</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;polar+h0&quot;</span><span class="p">,</span>
    <span class="n">series</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="n">maxabs</span><span class="p">,</span> <span class="n">maxabs</span><span class="p">),</span>
    <span class="n">background</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>

<span class="k">with</span> <span class="n">pygmt</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">FONT_TITLE</span><span class="o">=</span><span class="s2">&quot;12p&quot;</span><span class="p">):</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">projection</span><span class="o">=</span><span class="n">fig_proj</span><span class="p">,</span>
        <span class="n">region</span><span class="o">=</span><span class="n">xy_region</span><span class="p">,</span>
        <span class="n">frame</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;WSne+t</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;xa10000&quot;</span><span class="p">,</span> <span class="s2">&quot;ya10000&quot;</span><span class="p">],</span>
        <span class="n">x</span><span class="o">=</span><span class="n">easting</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="n">northing</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">total_field_anomaly_nt</span><span class="p">,</span>
        <span class="n">style</span><span class="o">=</span><span class="s2">&quot;c0.1c&quot;</span><span class="p">,</span>
        <span class="n">cmap</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s2">&quot;JMR&quot;</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;a200f100&quot;</span><span class="p">,</span> <span class="s2">&quot;x+lnT&quot;</span><span class="p">])</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>Most airborne surveys like this one present an anysotropic distribution of the
data: there are more observation points along the flight lines that goes west
to east than the ones going south to north.
Placing a single source beneath each observation point generates an anysotropic
distribution of the equivalent sources, which might lead to aliases on the
generated outputs.</p>
<p>Instead, we can use the <strong>block-averaged equivalent sources</strong> by
creating a <a class="reference internal" href="../../api/generated/harmonica.EquivalentSources.html#harmonica.EquivalentSources" title="harmonica.EquivalentSources"><code class="xref py py-class docutils literal notranslate"><span class="pre">harmonica.EquivalentSources</span></code></a> instance passing the size of
the blocks through the <code class="docutils literal notranslate"><span class="pre">block_size</span></code> parameter.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">harmonica</span> <span class="k">as</span> <span class="nn">hm</span>

<span class="n">eqs</span> <span class="o">=</span> <span class="n">hm</span><span class="o">.</span><span class="n">EquivalentSources</span><span class="p">(</span>
    <span class="n">depth</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">damping</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">block_size</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">depth_type</span><span class="o">=</span><span class="s2">&quot;constant&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>These sources were set at a constant depth of 1km bellow the zeroth height and
with a <code class="docutils literal notranslate"><span class="pre">damping</span></code> equal to 1. See how you can choose values for these
parameters in <a class="reference internal" href="eqs-parameters-estimation.html#eqs-parameters-estimation"><span class="std std-ref">Estimating damping and depth parameters</span></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The depth of the sources can be set analogously to the regular equivalent
sources: we can use a <code class="docutils literal notranslate"><span class="pre">constant</span></code> depth (every source is located at the same
depth) or a <code class="docutils literal notranslate"><span class="pre">relative</span></code> depth (where each source is located at a constant
shift beneath the median location obtained during the block-averaging process).
The depth of the sources and which strategy to use can be set up through the
<code class="docutils literal notranslate"><span class="pre">depth</span></code> and the <code class="docutils literal notranslate"><span class="pre">depth_type</span></code> parameters, respectively.</p>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>We recommend using a <code class="docutils literal notranslate"><span class="pre">block_size</span></code> not larger than the desired resolution
of the interpolation grid.</p>
</div>
<p>Now we can fit the equivalent sources against the magnetic data. During this
step the point sources are created through the block averaging process.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eqs</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">coordinates</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">total_field_anomaly_nt</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-1 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: black;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-1 {
  color: var(--sklearn-color-text);
}

#sk-container-id-1 pre {
  padding: 0;
}

#sk-container-id-1 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-1 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-1 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-1 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-1 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-1 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-1 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-1 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-1 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-1 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-1 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-1 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-1 label.sk-toggleable__label {
  cursor: pointer;
  display: block;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
}

#sk-container-id-1 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-1 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-1 div.sk-label label.sk-toggleable__label,
#sk-container-id-1 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-1 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-1 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-1 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-1 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-1 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 1ex;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-1 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-1 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-1 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-1 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>EquivalentSources(block_size=500, damping=1, depth=1000, depth_type=&#x27;constant&#x27;)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" checked><label for="sk-estimator-id-1" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;EquivalentSources<span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></label><div class="sk-toggleable__content fitted"><pre>EquivalentSources(block_size=500, damping=1, depth=1000, depth_type=&#x27;constant&#x27;)</pre></div> </div></div></div></div></div></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>We can obtain the coordinates of the created sources through the <code class="docutils literal notranslate"><span class="pre">points_</span></code>
attribute. Lets see how many sources it created:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eqs</span><span class="o">.</span><span class="n">points_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">size</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>3368
</pre></div>
</div>
</div>
</div>
<p>We have less sources than observation points indeed.</p>
</div>
<p>We can finally grid the magnetic data using the block-averaged equivalent
sources. We will generate a regular grid with a resolution of 500 m and at 1500
m height. Since the maximum height of the observation points is around 1000 m
we are efectivelly upward continuing the data.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid_coords</span> <span class="o">=</span> <span class="n">vd</span><span class="o">.</span><span class="n">grid_coordinates</span><span class="p">(</span>
    <span class="n">region</span><span class="o">=</span><span class="n">vd</span><span class="o">.</span><span class="n">get_region</span><span class="p">(</span><span class="n">coordinates</span><span class="p">),</span>
    <span class="n">spacing</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
    <span class="n">extra_coords</span><span class="o">=</span><span class="mi">1500</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">eqs</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">grid_coords</span><span class="p">,</span> <span class="n">data_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;magnetic_anomaly&quot;</span><span class="p">])</span>
<span class="n">grid</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 241kB
Dimensions:           (northing: 157, easting: 95)
Coordinates:
  * easting           (easting) float64 760B -3.24e+05 -3.235e+05 ... -2.769e+05
  * northing          (northing) float64 1kB 4.175e+06 4.176e+06 ... 4.253e+06
    upward            (northing, easting) float64 119kB 1.5e+03 ... 1.5e+03
Data variables:
    magnetic_anomaly  (northing, easting) float64 119kB 28.68 28.71 ... 157.7
Attributes:
    metadata:  Generated by EquivalentSources(block_size=500, damping=1, dept...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-e89e1947-898f-4412-8adb-d032a03ad2f7' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-e89e1947-898f-4412-8adb-d032a03ad2f7' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>northing</span>: 157</li><li><span class='xr-has-index'>easting</span>: 95</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-b1c0f988-3ca0-4029-bda9-dbd00e8d9929' class='xr-section-summary-in' type='checkbox'  checked><label for='section-b1c0f988-3ca0-4029-bda9-dbd00e8d9929' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>easting</span></div><div class='xr-var-dims'>(easting)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-3.24e+05 -3.235e+05 ... -2.769e+05</div><input id='attrs-335fa228-742a-4ae9-bb32-9f0c04229bfa' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-335fa228-742a-4ae9-bb32-9f0c04229bfa' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-55af0482-0344-4e96-b01b-0ba10aa4025d' class='xr-var-data-in' type='checkbox'><label for='data-55af0482-0344-4e96-b01b-0ba10aa4025d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-324001.54862 , -323500.364776, -322999.180932, -322497.997088,
       -321996.813244, -321495.6294  , -320994.445556, -320493.261712,
       -319992.077868, -319490.894024, -318989.71018 , -318488.526336,
       -317987.342492, -317486.158648, -316984.974804, -316483.79096 ,
       -315982.607116, -315481.423272, -314980.239428, -314479.055584,
       -313977.87174 , -313476.687896, -312975.504052, -312474.320208,
       -311973.136364, -311471.95252 , -310970.768676, -310469.584832,
       -309968.400988, -309467.217144, -308966.0333  , -308464.849456,
       -307963.665612, -307462.481768, -306961.297924, -306460.11408 ,
       -305958.930236, -305457.746392, -304956.562548, -304455.378704,
       -303954.19486 , -303453.011016, -302951.827172, -302450.643328,
       -301949.459484, -301448.27564 , -300947.091796, -300445.907952,
       -299944.724108, -299443.540264, -298942.35642 , -298441.172576,
       -297939.988732, -297438.804888, -296937.621044, -296436.4372  ,
       -295935.253356, -295434.069512, -294932.885668, -294431.701824,
       -293930.51798 , -293429.334136, -292928.150292, -292426.966448,
       -291925.782604, -291424.59876 , -290923.414916, -290422.231072,
       -289921.047228, -289419.863384, -288918.67954 , -288417.495696,
       -287916.311852, -287415.128008, -286913.944164, -286412.76032 ,
       -285911.576476, -285410.392632, -284909.208788, -284408.024944,
       -283906.8411  , -283405.657256, -282904.473412, -282403.289568,
       -281902.105724, -281400.92188 , -280899.738036, -280398.554192,
       -279897.370348, -279396.186504, -278895.00266 , -278393.818816,
       -277892.634972, -277391.451128, -276890.267284])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>northing</span></div><div class='xr-var-dims'>(northing)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>4.175e+06 4.176e+06 ... 4.253e+06</div><input id='attrs-5d098343-3dcf-4980-9ffb-4fef83a68568' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-5d098343-3dcf-4980-9ffb-4fef83a68568' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8603d2c4-454b-47c4-8a9b-fc42eb8fa8bb' class='xr-var-data-in' type='checkbox'><label for='data-8603d2c4-454b-47c4-8a9b-fc42eb8fa8bb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([4175067.781431, 4175567.603835, 4176067.426239, 4176567.248643,
       4177067.071047, 4177566.893451, 4178066.715855, 4178566.538259,
       4179066.360663, 4179566.183067, 4180066.005471, 4180565.827876,
       4181065.65028 , 4181565.472684, 4182065.295088, 4182565.117492,
       4183064.939896, 4183564.7623  , 4184064.584704, 4184564.407108,
       4185064.229512, 4185564.051916, 4186063.87432 , 4186563.696724,
       4187063.519128, 4187563.341532, 4188063.163936, 4188562.986341,
       4189062.808745, 4189562.631149, 4190062.453553, 4190562.275957,
       4191062.098361, 4191561.920765, 4192061.743169, 4192561.565573,
       4193061.387977, 4193561.210381, 4194061.032785, 4194560.855189,
       4195060.677593, 4195560.499997, 4196060.322401, 4196560.144806,
       4197059.96721 , 4197559.789614, 4198059.612018, 4198559.434422,
       4199059.256826, 4199559.07923 , 4200058.901634, 4200558.724038,
       4201058.546442, 4201558.368846, 4202058.19125 , 4202558.013654,
       4203057.836058, 4203557.658462, 4204057.480866, 4204557.303271,
       4205057.125675, 4205556.948079, 4206056.770483, 4206556.592887,
       4207056.415291, 4207556.237695, 4208056.060099, 4208555.882503,
       4209055.704907, 4209555.527311, 4210055.349715, 4210555.172119,
       4211054.994523, 4211554.816927, 4212054.639331, 4212554.461735,
       4213054.28414 , 4213554.106544, 4214053.928948, 4214553.751352,
       4215053.573756, 4215553.39616 , 4216053.218564, 4216553.040968,
       4217052.863372, 4217552.685776, 4218052.50818 , 4218552.330584,
       4219052.152988, 4219551.975392, 4220051.797796, 4220551.6202  ,
       4221051.442605, 4221551.265009, 4222051.087413, 4222550.909817,
       4223050.732221, 4223550.554625, 4224050.377029, 4224550.199433,
       4225050.021837, 4225549.844241, 4226049.666645, 4226549.489049,
       4227049.311453, 4227549.133857, 4228048.956261, 4228548.778665,
       4229048.60107 , 4229548.423474, 4230048.245878, 4230548.068282,
       4231047.890686, 4231547.71309 , 4232047.535494, 4232547.357898,
       4233047.180302, 4233547.002706, 4234046.82511 , 4234546.647514,
       4235046.469918, 4235546.292322, 4236046.114726, 4236545.93713 ,
       4237045.759535, 4237545.581939, 4238045.404343, 4238545.226747,
       4239045.049151, 4239544.871555, 4240044.693959, 4240544.516363,
       4241044.338767, 4241544.161171, 4242043.983575, 4242543.805979,
       4243043.628383, 4243543.450787, 4244043.273191, 4244543.095595,
       4245042.917999, 4245542.740404, 4246042.562808, 4246542.385212,
       4247042.207616, 4247542.03002 , 4248041.852424, 4248541.674828,
       4249041.497232, 4249541.319636, 4250041.14204 , 4250540.964444,
       4251040.786848, 4251540.609252, 4252040.431656, 4252540.25406 ,
       4253040.076464])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>upward</span></div><div class='xr-var-dims'>(northing, easting)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.5e+03 1.5e+03 ... 1.5e+03 1.5e+03</div><input id='attrs-c6fc5c55-ad6b-4da9-9db9-e507f6ba3f5d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c6fc5c55-ad6b-4da9-9db9-e507f6ba3f5d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-54f51be9-2812-48a2-979e-518c11094512' class='xr-var-data-in' type='checkbox'><label for='data-54f51be9-2812-48a2-979e-518c11094512' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[1500., 1500., 1500., ..., 1500., 1500., 1500.],
       [1500., 1500., 1500., ..., 1500., 1500., 1500.],
       [1500., 1500., 1500., ..., 1500., 1500., 1500.],
       ...,
       [1500., 1500., 1500., ..., 1500., 1500., 1500.],
       [1500., 1500., 1500., ..., 1500., 1500., 1500.],
       [1500., 1500., 1500., ..., 1500., 1500., 1500.]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-2609b29c-edb3-4244-a21b-01f54645fd75' class='xr-section-summary-in' type='checkbox'  checked><label for='section-2609b29c-edb3-4244-a21b-01f54645fd75' class='xr-section-summary' >Data variables: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>magnetic_anomaly</span></div><div class='xr-var-dims'>(northing, easting)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>28.68 28.71 28.68 ... 167.5 157.7</div><input id='attrs-38a1e86f-c6e3-4c04-ab60-bc84b2a42636' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-38a1e86f-c6e3-4c04-ab60-bc84b2a42636' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-74d95343-b7e9-49d4-bbe6-83b64576f725' class='xr-var-data-in' type='checkbox'><label for='data-74d95343-b7e9-49d4-bbe6-83b64576f725' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>metadata :</span></dt><dd>Generated by EquivalentSources(block_size=500, damping=1, depth=1000, depth_type=&#x27;constant&#x27;)</dd></dl></div><div class='xr-var-data'><pre>array([[  28.67794093,   28.70902862,   28.67531194, ...,  -40.4288177 ,
         -41.63671138,  -41.70466688],
       [  28.42593352,   28.15010485,   27.70229419, ...,  -46.36629196,
         -47.54835635,  -47.30391268],
       [  28.08726452,   27.65547081,   26.96106854, ...,  -52.05879178,
         -53.25362026,  -52.73096297],
       ...,
       [ -99.38643972, -102.59126519, -105.22124717, ...,  189.92893309,
         179.42484501,  169.44227383],
       [ -95.13160137,  -98.03214091, -100.5075938 , ...,  184.80774639,
         173.80268995,  163.78538101],
       [ -90.84441423,  -93.456212  ,  -95.76492836, ...,  178.59065885,
         167.53468387,  157.72824814]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-4e2cabd7-aff0-4847-9420-3bbb634af14c' class='xr-section-summary-in' type='checkbox'  ><label for='section-4e2cabd7-aff0-4847-9420-3bbb634af14c' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>easting</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-363be456-fcba-4478-a39c-817e95812733' class='xr-index-data-in' type='checkbox'/><label for='index-363be456-fcba-4478-a39c-817e95812733' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([-324001.54862008226,  -323500.3647760797, -322999.18093207723,
        -322497.9970880747, -321996.81324407214,  -321495.6294000696,
        -320994.4455560671, -320493.26171206456,   -319992.077868062,
        -319490.8940240595,   -318989.710180057, -318488.52633605443,
       -317987.34249205195,  -317486.1586480494, -316984.97480404685,
        -316483.7909600443,  -315982.6071160418,  -315481.4232720393,
       -314980.23942803673, -314479.05558403424,  -313977.8717400317,
       -313476.68789602915, -312975.50405202666,  -312474.3202080241,
        -311973.1363640216,   -311471.952520019, -310970.76867601654,
         -310469.584832014, -309968.40098801145, -309467.21714400896,
        -308966.0333000064, -308464.84945600387,  -307963.6656120014,
       -307462.48176799883,  -306961.2979239963, -306460.11407999374,
       -305958.93023599125,  -305457.7463919887, -304956.56254798616,
        -304455.3787039837, -303954.19485998113,  -303453.0110159786,
        -302951.8271719761, -302450.64332797355,   -301949.459483971,
       -301448.27563996846,   -300947.091795966,  -300445.9079519634,
        -299944.7241079609,  -299443.5402639584, -298942.35641995585,
        -298441.1725759533, -297939.98873195075, -297438.80488794827,
        -296937.6210439457,  -296436.4371999432,  -295935.2533559407,
       -295434.06951193814,  -294932.8856679356,  -294431.7018239331,
       -293930.51797993056,   -293429.334135928, -292928.15029192547,
         -292426.966447923, -291925.78260392044,  -291424.5987599179,
        -290923.4149159154, -290422.23107191286,  -289921.0472279103,
        -289419.8633839078,  -288918.6795399053, -288417.49569590273,
        -287916.3118519002,  -287415.1280078977, -286913.94416389515,
        -286412.7603198926,  -285911.5764758901,  -285410.3926318876,
         -284909.208787885,  -284408.0249438825,    -283906.84109988,
       -283405.65725587745,  -282904.4734118749,  -282403.2895678724,
       -281902.10572386987,  -281400.9218798673, -280899.73803586484,
        -280398.5541918623, -279897.37034785975, -279396.18650385726,
        -278895.0026598547, -278393.81881585217,  -277892.6349718496,
       -277391.45112784713,  -276890.2672838446],
      dtype=&#x27;float64&#x27;, name=&#x27;easting&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>northing</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-c34e2288-c663-4f40-a222-36715bdea5a5' class='xr-index-data-in' type='checkbox'/><label for='index-c34e2288-c663-4f40-a222-36715bdea5a5' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([4175067.7814308777,  4175567.603834939, 4176067.4262390006,
        4176567.248643062,  4177067.071047124, 4177566.8934511854,
        4178066.715855247, 4178566.5382593083, 4179066.3606633698,
       4179566.1830674317,
       ...
        4248541.674827921,  4249041.497231983,  4249541.319636044,
        4250041.142040106,  4250540.964444168,  4251040.786848229,
        4251540.609252291,  4252040.431656352,  4252540.254060414,
        4253040.076464475],
      dtype=&#x27;float64&#x27;, name=&#x27;northing&#x27;, length=157))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-663972c6-763c-434a-8a3a-99e352ebaa65' class='xr-section-summary-in' type='checkbox'  checked><label for='section-663972c6-763c-434a-8a3a-99e352ebaa65' class='xr-section-summary' >Attributes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>metadata :</span></dt><dd>Generated by EquivalentSources(block_size=500, damping=1, depth=1000, depth_type=&#x27;constant&#x27;)</dd></dl></div></li></ul></div></div></div></div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">pygmt</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

<span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Observed magnetic anomaly data&quot;</span>
<span class="n">pygmt</span><span class="o">.</span><span class="n">makecpt</span><span class="p">(</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;polar+h0&quot;</span><span class="p">,</span>
    <span class="n">series</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="n">maxabs</span><span class="p">,</span> <span class="n">maxabs</span><span class="p">),</span>
    <span class="n">background</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">with</span> <span class="n">pygmt</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">FONT_TITLE</span><span class="o">=</span><span class="s2">&quot;14p&quot;</span><span class="p">):</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">projection</span><span class="o">=</span><span class="n">fig_proj</span><span class="p">,</span>
        <span class="n">region</span><span class="o">=</span><span class="n">xy_region</span><span class="p">,</span>
        <span class="n">frame</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;WSne+t</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;xa10000&quot;</span><span class="p">,</span> <span class="s2">&quot;ya10000&quot;</span><span class="p">],</span>
        <span class="n">x</span><span class="o">=</span><span class="n">easting</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="n">northing</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">total_field_anomaly_nt</span><span class="p">,</span>
        <span class="n">style</span><span class="o">=</span><span class="s2">&quot;c0.1c&quot;</span><span class="p">,</span>
        <span class="n">cmap</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;a200f100&quot;</span><span class="p">,</span> <span class="s2">&quot;x+lnT&quot;</span><span class="p">])</span>

<span class="n">fig</span><span class="o">.</span><span class="n">shift_origin</span><span class="p">(</span><span class="n">xshift</span><span class="o">=</span><span class="n">fig_width</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Gridded and upward-continued&quot;</span>

<span class="k">with</span> <span class="n">pygmt</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">FONT_TITLE</span><span class="o">=</span><span class="s2">&quot;14p&quot;</span><span class="p">):</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">grdimage</span><span class="p">(</span>
        <span class="n">frame</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;ESnw+t</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;xa10000&quot;</span><span class="p">,</span> <span class="s2">&quot;ya10000&quot;</span><span class="p">],</span>
        <span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="o">.</span><span class="n">magnetic_anomaly</span><span class="p">,</span>
        <span class="n">cmap</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;a200f100&quot;</span><span class="p">,</span> <span class="s2">&quot;x+lnT&quot;</span><span class="p">])</span>

<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<hr class="docutils" />
<div class="sd-container-fluid sd-sphinx-override sd-mb-4 docutils">
<div class="sd-row sd-row-cols-2 sd-row-cols-xs-2 sd-row-cols-sm-2 sd-row-cols-md-2 sd-row-cols-lg-2 docutils">
<div class="sd-col sd-d-flex-row docutils">
<div class="sd-card sd-sphinx-override sd-w-100 sd-shadow-sm sd-text-center docutils">
<div class="sd-card-body docutils">
<div class="sd-card-title sd-font-weight-bold docutils">
<a class="reference download internal" download="" href="../../_downloads/fdbda62da95b0d31be01517026c20440/block-averaged-eqs.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">script</span></code></a></div>
</div>
</div>
</div>
<div class="sd-col sd-d-flex-row docutils">
<div class="sd-card sd-sphinx-override sd-w-100 sd-shadow-sm sd-text-center docutils">
<div class="sd-card-body docutils">
<div class="sd-card-title sd-font-weight-bold docutils">
<a class="reference download internal" download="" href="../../_downloads/1f7576c73bc5880a61a9d7907166c9e9/block-averaged-eqs.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook</span></code></a></div>
</div>
</div>
</div>
</div>
</div>
</div>


              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="eqs-parameters-estimation.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Estimating damping and depth parameters</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="gradient-boosted-eqs.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Gradient-boosted equivalent sources</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
        &copy; Copyright .<br/>
      Last updated on Mar 13, 2024.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>